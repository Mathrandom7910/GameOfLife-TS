var v=Object.defineProperty;var S=(n,e,t)=>e in n?v(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var l=(n,e,t)=>(S(n,typeof e!="symbol"?e+"":e,t),t);const x=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}};x();class m{constructor(e,t){l(this,"x");l(this,"y");if(e==null||t==null){this.x=0,this.y=0;return}if(e instanceof m)return this.x=e.x,this.y=e.y,this;this.x=e,this.y=t}equals(e){return this.x==e.x&&this.y==e.y}clone(){return new m(this)}add(e,t){const s=this.clone();return s.x+=e,s.y+=t,s}}class w extends m{constructor(e,t){super(e,t);l(this,"isDown",!1)}}class g extends m{constructor(e,t){super(e,t);l(this,"renX");l(this,"renY");l(this,"mouseOver",255);l(this,"isAlive",!1);l(this,"overing",!1);l(this,"size",c.cellSize);l(this,"isPressed",!1);l(this,"size1",0);this.renX=e*c.cellSize,this.renY=t*c.cellSize}update(){this.renX=this.x*c.cellSize,this.renY=this.y*c.cellSize}draw(){this.overing?this.mouseOver=Math.max(u.minLight,this.mouseOver-u.incAmt):this.mouseOver=Math.min(u.maxLight,this.mouseOver+u.incAmt),this.isPressed?this.size=Math.min(c.cellSize+u.maxSize,this.size+u.sizeInc):this.size=Math.max(c.cellSize,this.size-u.sizeInc),this.size1=this.size!=c.cellSize?this.size/10:0,this.mouseOver!=u.maxLight&&!this.isAlive&&(o.fillStyle=`rgb(${this.mouseOver}, ${this.mouseOver}, ${this.mouseOver})`,this.fillRect()),this.isAlive&&(o.fillStyle="black",this.fillRect()),o.strokeRect(this.renX-this.size1,this.renY-this.size1,this.size,this.size)}fillRect(){o.fillRect(this.renX-this.size1,this.renY-this.size1,this.size,this.size)}mouseIn(){this.overing=!0}mouseOut(){this.overing=!1}press(e=!1){return e||(this.isPressed=!0),this.isAlive=!this.isAlive}kill(){this.isAlive=!1}release(){this.isPressed=!1}}var d=document.getElementById("canv"),o=d.getContext("2d"),p=document.getElementById("settings"),z=document.getElementById("runSim"),y=document.getElementById("updateFrame"),k=document.getElementById("uFDisp"),C=document.getElementById("clearBtn"),u=(n=>(n[n.settingSize=25]="settingSize",n[n.maxTickCount=15]="maxTickCount",n[n.incAmt=10]="incAmt",n[n.minLight=100]="minLight",n[n.maxLight=200]="maxLight",n[n.maxSize=4]="maxSize",n[n.sizeInc=.2]="sizeInc",n))(u||{});const h=class{constructor(){l(this,"cells",[]);l(this,"mouse",new w);l(this,"fps",0);l(this,"lastCellOn",new g(0,0));l(this,"currentCell",new g(0,0));l(this,"isSettingUp",this.mouse.y<25);l(this,"isRunning",!1);l(this,"frameTime",0);l(this,"lastFrameTime",Date.now());l(this,"tickCount",0);l(this,"maxTickCount",15);l(this,"pressedCell",null);this.genCells(),p.style.height=`${25}px`,o.fillStyle="grey",C.onclick=()=>{this.cells.forEach(e=>e.forEach(t=>t.kill()))},z.oninput=()=>{this.isRunning=z.checked},y.oninput=()=>{this.maxTickCount=parseInt(y.value),k.innerHTML=`Update every ${y.value} frame${this.maxTickCount==1?"":"s"}`},document.onmousemove=e=>{if(this.mouse.x=e.clientX,this.mouse.y=e.clientY,this.isSettingUp=this.mouse.y<25,this.isSettingUp){p.style.display="block";return}else p.style.display="none";this.currentCell=this.getMouseCell(),this.currentCell.mouseIn(),this.currentCell.equals(this.lastCellOn)||this.lastCellOn.mouseOut(),this.lastCellOn=this.currentCell},document.onmousedown=()=>{this.isSettingUp||(this.mouse.isDown=!0,this.currentCell.press(),this.pressedCell=this.currentCell)},document.onmouseup=()=>{var e;this.isSettingUp||(this.mouse.isDown=!1,(e=this.pressedCell)==null||e.release())},document.onwheel=e=>{e.deltaY<0?h.cellSize+=1:h.cellSize-=1,this.genCells(!1),this.cullCells();for(let t=0;t<this.cells.length;t++)for(let s=0;s<this.cells[t].length;s++)this.cells[t][s].update()}}genCells(e=!0){for(let t=0;t<d.width/h.cellSize;t++)for(let s=0;s<d.height/h.cellSize;s++)this.cells[t]||(this.cells[t]=[]),!(!e&&this.cells[t][s]&&this.cells[t][s].isAlive)&&(this.cells[t][s]=new g(t,s))}cullCells(){var e,t;for(let s=0;s<((e=this.cells)==null?void 0:e.length);s++)for(let i=0;i<((t=this.cells[s])==null?void 0:t.length);i++)(s*h.cellSize>=innerWidth||i*h.cellSize>=innerHeight)&&this.cells[s].splice(i,1),this.cells[s].length==0&&this.cells.splice(s,1)}getClass(){return h}getMouseCell(){return this.cells[Math.floor(this.mouse.x/h.cellSize)][Math.floor(this.mouse.y/h.cellSize)]}render(){o.clearRect(0,0,d.width,d.height),this.tickCount++,this.frameTime=Date.now()-this.lastFrameTime,this.lastFrameTime=Date.now(),this.fps=Math.floor(1e3/this.frameTime);var e=null;o.strokeStyle="darkgrey";for(let t=0;t<this.cells.length;t++)for(let s=0;s<this.cells[t].length;s++)this.cells[t][s].draw(),this.cells[t][s].isPressed&&(e=this.cells[t][s]);e==null||e.draw(),this.isRunning&&this.tickCount>=this.maxTickCount&&(this.tick(),this.tickCount=0),o.strokeStyle="black",o.fillText(`FPS: ${this.fps}`,20,20),o.strokeText(`FPS: ${this.fps}`,20,20),requestAnimationFrame(this.render)}tick(){let e=[];for(let t=0;t<this.cells.length;t++)for(let s=0;s<this.cells[t].length;s++){const i=this.cells[t][s],r=this.getCellsArround(t,s);if(r<2&&i.isAlive){e.push(i);continue}if(r>3&&i.isAlive&&e.push(i),r==3&&!i.isAlive){e.push(i);continue}}e.forEach(t=>t.press(!0))}getCellsArround(e,t){let s=0;for(let i=-1;i<=1;i++)for(let r=-1;r<=1;r++)i==0&&r==0||this.cells[e+i]==null||this.cells[e+i][t+r]==null||this.cells[e+i][t+r].isAlive&&s++;return s}};let c=h;l(c,"cellSize",20);var a;(onresize=()=>{d.width=window.innerWidth,d.height=window.innerHeight,a==null||a.genCells(!1),o.font="20px Arial"})();a=new c;a.render=a.render.bind(a);a.render();window.game=a;
